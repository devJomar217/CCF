<style>
    #question-description>p>img {
        width: 100%;
    }
    
    figure>img {
        width: 100%;
    }
</style>
<link rel="stylesheet" type="text/css" href="./../../common/ckeditor/styles.css">
<div class="row mb-5">
    <div class="col-lg-4 col-12 pb-3">
        <div class="card shadow-sm">
            <div class="card-body">
                <div id="card-form">
                    <h4>Question</h4>
                    <h5 class="mt-4" id="question-title"></h5>
                    <p class="mt-3" id="question-description"></p>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-8 col-12">
        <div class="card shadow-sm">
            <div class="card-body">
                <div id="card-form">
                    <h4 class="ml-1 pl-1">Enter Your Answer</h4>
                    <form id="form-answer-now" class="mt-4">
                        <div class="centered">
                            <div class="row row-editor">
                                <div class="editor-container">
                                    <div class="editor">
                                        <h5>Answer:</h5>
                                        <br>
                                        <h5>Explanation:</h5>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col flex-row-reverse text-right">
                            <button type="submit" value="Submit" class="btn btn-primary mt-4" style="background-color: #4e73df !important;">Answer Now <i class="fa fa-paper-plane"></i></button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="./../../common/ckeditor/script.js"></script>
<script>
    $(document).ready(function() {
        var questionID = window.location.search.substring(1).split("=")[1];
        var creatorID = "";
        retrieveQuestion();
        $("#form-answer-now").on("submit", function(e) {
            e.preventDefault();
            $.ajax({
                url: "../../common/db.php",
                type: "POST",
                data: {
                    action: 'save-answer',
                    questionID: questionID,
                    answer: window.editor.getData(),
                    creatorID: creatorID
                },
                cache: false,
                success: function(dataResult) {
                    var dataResult = JSON.parse(dataResult);
                    if (dataResult.statusCode == 200) {
                        window.history.back();
                        $("#main-container").load('./form-main-forum.html');
                        alert("Success!");
                    } else {
                        alert("Unable to post the answer, please try again later!");
                    }
                }
            });
        });

        function retrieveQuestion() {
            $.ajax({
                url: "../../common/db.php",
                type: "POST",
                data: {
                    action: 'retrieve-question',
                    questionID: questionID
                },
                cache: false,
                success: function(dataResult) {
                    var dataResult = JSON.parse(dataResult);
                    if (dataResult.statusCode == 200) {
                        $("#question-title").html(dataResult.question.title);
                        $("#question-description").html(dataResult.question.description);
                        creatorID = dataResult.question.studentID;
                    } else {
                        alert("Unable to post the answer, please try again later!");
                    }
                }
            });
        }
    });
</script>